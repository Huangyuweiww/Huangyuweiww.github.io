<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>asp.net调用WebServices</title>
    <url>/2020/04/09/hello-world/</url>
    <content><![CDATA[<h3 id="调用天气预报"><a href="#调用天气预报" class="headerlink" title="调用天气预报"></a>调用天气预报</h3><h4 id="效果如下："><a href="#效果如下：" class="headerlink" title="效果如下："></a>效果如下：</h4><p><img src="/images/webserviceXiaoguo.png" alt=""></p>
<a id="more"></a>
<p>1、打开Vs创建一个空网站<br><img src="/images/1.png" alt=""><br>2、在添加的空网站上右键添加服务引用。<br><img src="/images/2.png" alt=""><br>3、选择高级，然后点击添加web服务引用，并将要掉用的api地址粘贴到url文本框内，接着点击右侧的箭头（vs2017）,vs2019右侧没有小箭头，粘贴后直接回车。<br><img src="/images/3.png" alt=""></p>
<p>4、调用接口<br>.html文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">       &lt;h1&gt;Asp.Net 调用WebService实现天气预报&lt;/h1&gt;</span><br><span class="line">       请输入城市名称：&lt;asp:TextBox ID=<span class="string">"txtcity"</span> runat=<span class="string">"server"</span>&gt;&lt;/asp:TextBox&gt;</span><br><span class="line">       &lt;asp:Label ID=<span class="string">"Label1"</span> runat=<span class="string">"server"</span> Style=<span class="string">"color: red"</span> BorderColor=<span class="string">"Red"</span> Text=<span class="string">"如 ：上海"</span>&gt;&lt;/asp:Label&gt;</span><br><span class="line">       &lt;asp:Button ID=<span class="string">"btncheck"</span> runat=<span class="string">"server"</span> Text=<span class="string">"查询"</span> Width=<span class="string">"69px"</span> OnClick=<span class="string">"btncheck_Click"</span> /&gt;&lt;br /&gt;</span><br><span class="line">       天气概况 ：</span><br><span class="line">       &lt;asp:Label ID=<span class="string">"lbtianqi"</span> runat=<span class="string">"server"</span> Style=<span class="string">""</span> BorderColor=<span class="string">"Red"</span> Text=<span class="string">""</span>&gt;&lt;/asp:Label&gt;</span><br><span class="line">       &lt;br /&gt;</span><br><span class="line">       天气实况 ：</span><br><span class="line">   &lt;br /&gt;</span><br><span class="line">       &lt;asp:TextBox ID=<span class="string">"txtcityweather"</span> runat=<span class="string">"server"</span> Height=<span class="string">"62px"</span> TextMode=<span class="string">"MultiLine"</span> Width=<span class="string">"258px"</span>&gt;&lt;/asp:TextBox&gt;</span><br><span class="line">       &lt;br /&gt;</span><br><span class="line">   &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>.cs文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">protected void btncheck_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    //new一个天气服务对象</span><br><span class="line">    WeatherService.WeatherWebService w = new WeatherService.WeatherWebService();</span><br><span class="line">    string[] res = new string[23];</span><br><span class="line">    string cityname = txtcity.Text.Trim();</span><br><span class="line">    //调用天气查询的方法</span><br><span class="line">    res = w.getWeatherbyCityName(cityname);</span><br><span class="line">    //显示天气数据</span><br><span class="line">    lbtianqi.Text = cityname + <span class="string">" "</span> + res[6];</span><br><span class="line">    txtcityweather.Text = res[10];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
  </entry>
</search>
